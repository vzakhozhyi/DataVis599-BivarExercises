---
title: "V2 TabularData Bivariate Class Exercises"
author: "Vitalii Zakhozhyi"
---

**Calling data and preparing it for exercises**

```{r collect, eval=FALSE}
link="https://github.com/EvansDataScience/data/raw/master/crime.RData"
load(file = url(link))
names(crime)
head(crime)
str(crime,width = 100,strict.width='cut')
```

```{r table, eval=FALSE}
library(magrittr)
CrimeTotal=table(crime$crimecat,crime$Occurred.DayTime)%>% #create table and then...
        prop.table() %>% #compute proportion and then...
        "*"(100)%>% # multiply by 100 and then...
        round(2) #...round to to decimals
CrimeTotal

CrimeCol=table(crime$crimecat,crime$Occurred.DayTime)%>%
         prop.table(margin = 2)%>%   # 2 is % by column
         "*"(100)%>%
         round(3)

CrimeCol
```

```{r convertToDFgg,eval=FALSE}
df.T=as.data.frame(CrimeTotal) # table of proportion based on total
names(df.T)=c('Crime','Daytime','Percent') #renaming
head(df.T)
```

```{r plotTable_gg, eval=FALSE}
library(ggplot2)                           
base = ggplot(df.T, aes(Daytime,Crime))
tablePlot1 = base + geom_point(aes(size = Percent), colour = "gray") 
tablePlot2 = tablePlot1 + geom_text(aes(label = Percent),
                                    nudge_x = 0.1,
                                    size=2)
tablePlot3 = tablePlot2 + scale_size_continuous(range=c(0,10)) #change 10?
tablePlot4 = tablePlot3 + theme_minimal() # less ink
tablePlot5 = tablePlot4 + theme(legend.position="none") # no legend
tablePlot5
```


```{r flip_facet, eval=FALSE}
df.C=as.data.frame(CrimeCol)
colnames(df.C)=c('Crime','Daytime','Percent')
base  = ggplot(df.C, aes(x = reorder(Crime, Percent), y = Percent ) ) 
bars1 = base + geom_bar( stat = "identity" )
bars2 = bars1 + facet_wrap( ~ Daytime ,nrow = 1) 
bars3 = bars2 + coord_flip() + theme(axis.text.y = element_text(size=4,angle = 45))
bars3
```


**Exercise 1: Turn the bars into lollipop with the right components.**

Excercise 1 solution:

```{r lollipopcrime}
base = ggplot(df.C, aes(x = reorder(Crime, Percent), y = Percent))
lol1 = base + geom_segment(aes(y = 0,
                           x = reorder(Crime, Percent),
                           yend = Percent,
                           xend = reorder(Crime, Percent))) +
              geom_point()
lol2 = lol1 + facet_wrap( ~ Daytime ,nrow = 1) 
lol3 = lol2 + coord_flip() + 
              scale_y_continuous(labels=scales::unit_format(suffix = '%'))
lol4 = lol3 + labs(title='Crime frequencies in Seattle during different daytime',
                   x ='Type of crime',
                   y = 'Percent',
                   caption = 'Source: Seattle Open Data Portal')
lol5 = lol4 + theme(axis.text.y = element_text(size=5, angle = 45),
                    axis.text.x = element_text(size=7),
                    plot.title = element_text(size = 15, hjust = 0.5),
                    plot.caption = element_text(hjust = 1, vjust = -1.2),
                    axis.title.y = element_text(size = 12, hjust = 0.5, vjust = 1.75),
                    axis.title.x = element_text(size = 12, hjust = 0.5, vjust = -1.25))
lol5
```



**Exercise 2: Change the heatplot to ascending order, where intensity goes from yellow to purple.**

Excercise 2 solution:

```{r heatDAscending}
base  = ggplot(df.C, aes(x = Daytime, y = reorder(Crime, -Percent), fill = Percent)) #changing order to ascending
heat1 = base + geom_tile() 
heat2 = heat1 + scale_fill_gradient(low = "yellow", 
                                   high = "purple")
heat3 = heat2 + theme_classic() 
heat4 = heat3 + theme(axis.text.x = element_text(size=10, vjust = 0.6),
                      axis.text.y = element_text(size=6, angle = 30),
                      plot.title = element_text(size = 15, hjust = 0.5),
                      plot.caption = element_text(hjust = 1, vjust = -1.2),
                      axis.title.y = element_text(size = 12, hjust = 0.5, vjust = 1.75),
                      axis.title.x = element_text(size = 12, hjust = 0.5, vjust = -1.25),
                      legend.title = element_blank(),
                      legend.position="top", 
                      legend.direction="horizontal",
                      legend.key.width=unit(1, "cm"),
                      legend.key.height=unit(1, "cm")) 
heat5 = heat4 + labs(y="Crime",
                     title='Crime frequencies in Seattle during different daytime',
                     caption = 'Source: Seattle Open Data Portal')
heat5
```


**Exercise 3: Complete the information needed in the previous plots.**

Excercise 3 solution:
```{r}

```



**Exercise 4: Complete the elements missing in the previous plots.**

Excercise 4 solution:
```{r}

```


